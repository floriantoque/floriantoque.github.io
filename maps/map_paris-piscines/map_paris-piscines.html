
<!DOCTYPE html>
<html>
<head>
	<title>Piscines visitées</title>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
	<link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.css" />

	<style>
  body { margin:0; padding:0; }
  #map { position:absolute; top:0; bottom:0; width:100%; }
	</style>

<style>
	body {
	    padding: 0;
	    margin: 0;
	}
	html, body, #map {
	    height: 100%;
	}
</style>

</head>
<body>


	<div id="map"></div>

	<script src="geojs.js" type="text/javascript"></script>
	<script src="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.js"></script>
	<script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
	<script
				  src="https://code.jquery.com/jquery-2.2.2.min.js"
				  integrity="sha256-36cp2Co+/62rEAAYHLmRCPIych47CvdM+uTBJwSzWjI="
				  crossorigin="anonymous"></script>
	<script>






		//creation des icones
		var redIcon = L.icon({
			iconUrl: 'logo1_nat_rouge.png',
			iconSize:     [60, 60], // size of the icon
			iconAnchor:   [30, 30], // point of the icon which will correspond to marker's location
			popupAnchor:  [0, -15] // point from which the popup should open relative to the iconAnchor
		});

		var blueIcon = L.icon({
			iconUrl: 'logo1_nat_bleu.png',
			iconSize:     [60, 60], // size of the icon
			iconAnchor:   [30, 30], // point of the icon which will correspond to marker's location
			popupAnchor:  [0, -15] // point from which the popup should open relative to the iconAnchor
		});



		var m33=[];
		var m50=[];
		var m25=[];

		for (i = 0 ; i < data.features.length ; i++){
			var popupContent = "<b><u> " +data.features[i].properties["name"] + ": </u> </b> "
												+ "<br><br><b>Adresse: </b>"+data.features[i].properties["address"]
												+ "<br><b>Longueur: </b>"+data.features[i].properties["metre"] + "M"
												+ "<br><b>Tél: </b>"+data.features[i].properties["phone"];
			if(data.features[i].properties['metre']==25){
				if (data.features[i].properties["visited"]==0){
					m25.push(L.marker(data.features[i].geometry["coordinates"].reverse(),{icon: redIcon}).bindPopup(popupContent));
				}
				else {
					m25.push(L.marker(data.features[i].geometry["coordinates"].reverse(),{icon: blueIcon}).bindPopup(popupContent));
				}
			}
			if(data.features[i].properties['metre']==33){
				if (data.features[i].properties["visited"]==0){
					m33.push(L.marker(data.features[i].geometry["coordinates"].reverse(),{icon: redIcon}).bindPopup(popupContent));
				}
				else {
					m33.push(L.marker(data.features[i].geometry["coordinates"].reverse(),{icon: blueIcon}).bindPopup(popupContent));
				}
			}
			if(data.features[i].properties['metre']==50){
				if (data.features[i].properties["visited"]==0){
					m50.push(L.marker(data.features[i].geometry["coordinates"].reverse(),{icon: redIcon}).bindPopup(popupContent));
				}
				else {
					m50.push(L.marker(data.features[i].geometry["coordinates"].reverse(),{icon: blueIcon}).bindPopup(popupContent));
				}
			}
		}
		var m25_group=L.layerGroup(m25)
		var m33_group=L.layerGroup(m33)
		var m50_group=L.layerGroup(m50)

		var overlayMaps = {
		"25M": m25_group,
    "33M": m33_group,
		"50M": m50_group
		};



		//creation carte
		var mapQuest = L.tileLayer('https://otile1-s.mqcdn.com/tiles/1.0.0/map/{z}/{x}/{y}.png', {
    attribution: '&copy; <a href="https://www.mapquest.com/">MAPQUEST</a> &copy; <a href="https://www.OpenStreetMap.com/">OpenStreetMap</a> contributors'
		});

		var osm_grey = L.tileLayer('https://tiles.wmflabs.org/bw-mapnik/{z}/{x}/{y}.png', {
    attribution: ' &copy; <a href="https://www.OpenStreetMap.com/">OpenStreetMap</a> contributors'
		});

		var stamen_watercolor = L.tileLayer('http://c.tile.stamen.com/watercolor/{z}/{x}/{y}.png', {
    attribution: '&copy; <a href="http://maps.stamen.com/">Maps Stamen</a>'
		});


		var osm_hot = L.tileLayer('http://a.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png', {
    attribution: '&copy; <a href="https://www.OpenStreetMap.com/">OpenStreetMap</a> contributors'
		});

		var osm = L.tileLayer('http://a.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: ' &copy; <a href="https://www.OpenStreetMap.com/">OpenStreetMap</a> contributors'
		});


		var map = new L.map('map',{minZoom: 5}).setView([48.8588150,2.3453283], 12);



		 var baseLayers = {
			"osm": osm,
			"osm_grey": osm_grey,
			"osm_hot": osm_hot,
			"osm_mapquest": mapQuest,
			"Stamen_watercolor":stamen_watercolor,
		 };

		osm_hot.addTo(map);
		m25_group.addTo(map);
		m33_group.addTo(map);
		m50_group.addTo(map);

		L.control.layers(baseLayers, overlayMaps).addTo(map);





		// fonction qui va être appliqué a chaque objet pour associé le popup
		// function onEachFeature(feature, layer) {
		// 	var popupContent = "<br><b><u> " +feature.properties["name"] + ": </u> </b> "
		// 										+ "<br><b>Adresse: </b>"+feature.properties["address"]
		// 										+ "<br><b>Longueur: </b>"+feature.properties["metre"] + "M"
		// 										+ "<br><b>Tél: </b>"+feature.properties["phone"];
		//
		// 	layer.bindPopup(popupContent);
		// }



		// L.geoJson(data.features, {
		//
		// 	style: function (feature) {
		// 		return feature.properties && feature.properties.style;
		// 	},
		// 	onEachFeature: onEachFeature,
		//
		// 	pointToLayer: function (feature, latlng) {
		// 		if (feature.properties["visited"]==0){
		// 			return L.marker(latlng, {icon: redIcon});
		// 		}
		// 		else {
		// 			return L.marker(latlng, {icon: blueIcon});
		// 		}
		// 	}
		//
		// }).addTo(map);



	</script>
</body>
</html>
